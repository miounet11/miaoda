# MiaoDa Chat ç¬¬äº”é˜¶æ®µäº¤äº’è®¾è®¡æŒ‡å—

## ğŸ¨ ä¸“ä¸šUI/UXäº¤äº’è®¾è®¡æ–¹æ¡ˆ

**åˆ¶å®šä¸“å®¶**: UI/UXäº¤äº’è®¾è®¡ä¸“å®¶ (10å¹´+ä¼ä¸šçº§ç»éªŒ)  
**è®¾è®¡åŸåˆ™**: ç”¨æˆ·ä¸­å¿ƒè®¾è®¡ + æ— éšœç¢è®¿é—® + ç°ä»£åŒ–äº¤äº’  
**è®¾è®¡ç›®æ ‡**: æ‰“é€ ç›´è§‚ã€é«˜æ•ˆã€ä»¤äººæ„‰æ‚¦çš„ç”¨æˆ·ç•Œé¢  
**å®Œæˆæ—¶é—´**: 2025-07-30

---

## ğŸ¯ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ¸å¿ƒäº¤äº’è®¾è®¡åŸåˆ™

### 1.1 è®¾è®¡å“²å­¦

#### **ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„è®¾è®¡ç†å¿µ**
- **è®¤çŸ¥è´Ÿè·æœ€å°åŒ–**: æ¯ä¸ªç•Œé¢å…ƒç´ éƒ½æœ‰æ˜ç¡®ç›®çš„
- **æ“ä½œè·¯å¾„æœ€çŸ­åŒ–**: å¸¸ç”¨åŠŸèƒ½2æ­¥å†…å®Œæˆ
- **åé¦ˆå³æ—¶åŒ–**: æ¯ä¸ªæ“ä½œéƒ½æœ‰æ¸…æ™°çš„è§†è§‰åé¦ˆ
- **é”™è¯¯é¢„é˜²**: é€šè¿‡è®¾è®¡é¿å…ç”¨æˆ·çŠ¯é”™

#### **æ— éšœç¢è®¾è®¡æ ‡å‡†**
- **WCAG 2.1 AAçº§åˆè§„**: æ”¯æŒå±å¹•é˜…è¯»å™¨
- **é”®ç›˜å¯¼èˆªå‹å¥½**: å…¨åŠŸèƒ½é”®ç›˜æ“ä½œæ”¯æŒ
- **é«˜å¯¹æ¯”åº¦æ¨¡å¼**: è§†è§‰éšœç¢ç”¨æˆ·å‹å¥½
- **è¯­éŸ³äº¤äº’æ”¯æŒ**: æœªæ¥æ‰©å±•è¯­éŸ³æ“ä½œ

### 1.2 è§†è§‰è®¾è®¡è¯­è¨€

#### **è‰²å½©ç³»ç»Ÿä¼˜åŒ–**
```css
/* ä¸»è‰²å½©å®šä¹‰ */
:root {
  /* ä¸»å“ç‰Œè‰² - ä¿æŒä¸“ä¸šæ„Ÿ */
  --primary-50: #f0f9ff;
  --primary-500: #3b82f6;
  --primary-600: #2563eb;
  --primary-700: #1d4ed8;
  
  /* åŠŸèƒ½è‰²å½© - å¢å¼ºè¯­ä¹‰åŒ– */
  --success: #10b981;
  --warning: #f59e0b;
  --error: #ef4444;
  --info: #6366f1;
  
  /* ä¸­æ€§è‰²ä¼˜åŒ– - æå‡å¯è¯»æ€§ */
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-500: #6b7280;
  --gray-900: #111827;
  
  /* æ·±è‰²æ¨¡å¼ä¼˜åŒ– */
  --dark-bg-primary: #0f172a;
  --dark-bg-secondary: #1e293b;
  --dark-text-primary: #f1f5f9;
  --dark-text-secondary: #cbd5e1;
}
```

#### **å­—ä½“å±‚çº§ç³»ç»Ÿ**
```css
/* å­—ä½“å±‚çº§ - ç¡®ä¿ä¿¡æ¯å±‚æ¬¡æ¸…æ™° */
.text-display {
  font-size: 2.25rem; /* 36px */
  font-weight: 700;
  line-height: 1.2;
  letter-spacing: -0.025em;
}

.text-heading-1 {
  font-size: 1.875rem; /* 30px */
  font-weight: 600;
  line-height: 1.3;
}

.text-heading-2 {
  font-size: 1.5rem; /* 24px */
  font-weight: 600;
  line-height: 1.4;
}

.text-body-large {
  font-size: 1.125rem; /* 18px */
  font-weight: 400;
  line-height: 1.6;
}

.text-body {
  font-size: 1rem; /* 16px */
  font-weight: 400;
  line-height: 1.6;
}

.text-body-small {
  font-size: 0.875rem; /* 14px */
  font-weight: 400;
  line-height: 1.5;
}

.text-caption {
  font-size: 0.75rem; /* 12px */
  font-weight: 500;
  line-height: 1.4;
  letter-spacing: 0.025em;
}
```

---

## ğŸ” ç¬¬äºŒéƒ¨åˆ†ï¼šå…¨å±€æœç´¢ç•Œé¢é‡æ–°è®¾è®¡

### 2.1 æœç´¢å…¥å£è®¾è®¡

#### **é¡¶éƒ¨æœç´¢æ å®ç°**
```vue
<template>
  <div class="global-search-trigger">
    <!-- ä¸»æœç´¢æŒ‰é’® -->
    <button 
      class="search-trigger-btn"
      @click="openGlobalSearch"
      :class="{ 'active': isSearchOpen }"
    >
      <Search :size="16" class="search-icon" />
      <span class="search-text">æœç´¢æ¶ˆæ¯å’Œå¯¹è¯</span>
      <div class="shortcut-hint">
        <kbd>âŒ˜</kbd><kbd>K</kbd>
      </div>
    </button>
    
    <!-- å¿«é€Ÿæœç´¢å»ºè®® -->
    <div class="search-suggestions" v-if="showSuggestions">
      <div class="suggestion-item" v-for="suggestion in suggestions" :key="suggestion.id">
        <div class="suggestion-icon">
          <component :is="suggestion.icon" :size="14" />
        </div>
        <span class="suggestion-text">{{ suggestion.text }}</span>
        <div class="suggestion-count">{{ suggestion.count }}</div>
      </div>
    </div>
  </div>
</template>

<style scoped>
.search-trigger-btn {
  @apply flex items-center gap-3 w-full max-w-md px-4 py-2.5 bg-muted/50 hover:bg-muted/70 
         border border-border rounded-xl transition-all duration-200 group;
  
  &:hover, &.active {
    @apply border-primary/30 shadow-sm;
    
    .search-icon {
      @apply text-primary;
    }
  }
  
  &:focus-visible {
    @apply ring-2 ring-primary/20 ring-offset-2;
  }
}

.search-text {
  @apply flex-1 text-left text-muted-foreground text-sm;
  
  .search-trigger-btn:hover & {
    @apply text-foreground;
  }
}

.shortcut-hint {
  @apply flex items-center gap-1;
  
  kbd {
    @apply px-1.5 py-0.5 bg-background border border-border rounded text-xs font-mono;
  }
}

.search-suggestions {
  @apply absolute top-full left-0 right-0 mt-2 bg-background border border-border 
         rounded-lg shadow-lg z-50 py-2;
  
  .suggestion-item {
    @apply flex items-center gap-3 px-4 py-2 hover:bg-muted/50 cursor-pointer;
    
    .suggestion-count {
      @apply ml-auto text-xs text-muted-foreground;
    }
  }
}
</style>
```

### 2.2 æœç´¢æ¨¡æ€çª—å£é‡æ–°è®¾è®¡

#### **ç®€åŒ–çš„æœç´¢ç•Œé¢**
```vue
<template>
  <div class="search-modal-overlay" v-if="isOpen" @click.self="close">
    <div class="search-modal" :class="modalSizeClass">
      <!-- æœç´¢å¤´éƒ¨ -->
      <div class="search-header">
        <div class="search-input-container">
          <Search :size="20" class="search-input-icon" />
          <input
            ref="searchInput"
            v-model="searchQuery"
            type="text"
            placeholder="æœç´¢æ¶ˆæ¯ã€å¯¹è¯æˆ–ç”¨æˆ·..."
            class="search-input"
            @input="onSearchInput"
            @keydown="handleKeydown"
          />
          <button 
            v-if="searchQuery" 
            @click="clearSearch"
            class="clear-button"
          >
            <X :size="16" />
          </button>
        </div>
        
        <!-- æœç´¢è¿‡æ»¤å™¨ -->
        <div class="search-filters" v-if="showFilters">
          <FilterChip
            v-for="filter in quickFilters"
            :key="filter.id"
            :filter="filter"
            :active="activeFilters.includes(filter.id)"
            @toggle="toggleFilter"
          />
        </div>
      </div>
      
      <!-- æœç´¢å†…å®¹åŒº -->
      <div class="search-content">
        <!-- ç©ºçŠ¶æ€ -->
        <div v-if="!searchQuery && !isSearching" class="search-empty-state">
          <div class="empty-icon">
            <Search :size="48" />
          </div>
          <h3 class="empty-title">æœç´¢ä½ çš„æ¶ˆæ¯</h3>
          <p class="empty-description">è¾“å…¥å…³é”®è¯æœç´¢å†å²å¯¹è¯å’Œæ¶ˆæ¯</p>
          
          <!-- æœç´¢å»ºè®® -->
          <div class="search-suggestions-grid">
            <button 
              v-for="suggestion in searchSuggestions"
              :key="suggestion.id"
              @click="applySuggestion(suggestion)"
              class="suggestion-card"
            >
              <component :is="suggestion.icon" :size="20" />
              <span>{{ suggestion.text }}</span>
            </button>
          </div>
        </div>
        
        <!-- æœç´¢ç»“æœ -->
        <div v-else-if="searchResults.length > 0" class="search-results">
          <div class="results-header">
            <span class="results-count">æ‰¾åˆ° {{ searchResults.length }} æ¡ç»“æœ</span>
            <div class="results-sort">
              <select v-model="sortBy" class="sort-select">
                <option value="relevance">ç›¸å…³æ€§</option>
                <option value="date">æ—¶é—´</option>
                <option value="chat">å¯¹è¯</option>
              </select>
            </div>
          </div>
          
          <div class="results-list">
            <SearchResultItem
              v-for="result in displayResults"
              :key="result.id"
              :result="result"
              :query="searchQuery"
              @click="selectResult"
              @action="handleResultAction"
            />
          </div>
        </div>
        
        <!-- æ— ç»“æœçŠ¶æ€ -->
        <div v-else-if="searchQuery && !isSearching" class="no-results">
          <div class="no-results-icon">
            <SearchX :size="48" />
          </div>
          <h3 class="no-results-title">æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</h3>
          <p class="no-results-description">
            å°è¯•ä½¿ç”¨ä¸åŒçš„å…³é”®è¯æˆ–è°ƒæ•´æœç´¢è¿‡æ»¤å™¨
          </p>
          <button @click="showAdvancedSearch" class="advanced-search-btn">
            é«˜çº§æœç´¢
          </button>
        </div>
        
        <!-- åŠ è½½çŠ¶æ€ -->
        <div v-else-if="isSearching" class="search-loading">
          <div class="loading-spinner">
            <Loader2 :size="32" class="animate-spin" />
          </div>
          <p class="loading-text">æ­£åœ¨æœç´¢...</p>
        </div>
      </div>
      
      <!-- æœç´¢åº•éƒ¨ -->
      <div class="search-footer">
        <div class="search-stats">
          <span class="stats-text">
            å·²ç´¢å¼• {{ indexedMessages }} æ¡æ¶ˆæ¯
          </span>
        </div>
        
        <div class="search-actions">
          <button @click="toggleFilters" class="action-btn">
            <Filter :size="16" />
            è¿‡æ»¤å™¨
          </button>
          <button @click="openAdvancedSearch" class="action-btn">
            <Settings :size="16" />
            é«˜çº§
          </button>
          <button @click="close" class="action-btn">
            <Escape :size="16" />
            å…³é—­
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped>
.search-modal-overlay {
  @apply fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-start justify-center pt-20;
  animation: fadeIn 0.2s ease-out;
}

.search-modal {
  @apply bg-background border border-border rounded-xl shadow-2xl overflow-hidden 
         flex flex-col max-h-[80vh] w-full mx-4;
  animation: slideDown 0.3s ease-out;
  max-width: 700px;
  
  &.large {
    max-width: 900px;
    max-height: 90vh;
  }
}

.search-header {
  @apply border-b border-border p-4 space-y-3;
}

.search-input-container {
  @apply relative flex items-center;
}

.search-input-icon {
  @apply absolute left-3 text-muted-foreground;
}

.search-input {
  @apply w-full pl-10 pr-10 py-3 bg-transparent border-0 outline-none text-lg 
         placeholder:text-muted-foreground;
  
  &:focus {
    @apply outline-none;
  }
}

.clear-button {
  @apply absolute right-3 p-1 rounded-md hover:bg-muted transition-colors;
}

.search-filters {
  @apply flex flex-wrap gap-2;
}

.search-content {
  @apply flex-1 overflow-y-auto p-4;
}

/* ç©ºçŠ¶æ€æ ·å¼ */
.search-empty-state {
  @apply text-center py-12;
}

.empty-icon {
  @apply inline-flex items-center justify-center w-20 h-20 bg-muted/30 rounded-full mb-6;
  
  svg {
    @apply text-muted-foreground;
  }
}

.empty-title {
  @apply text-xl font-semibold mb-2;
}

.empty-description {
  @apply text-muted-foreground mb-8;
}

.search-suggestions-grid {
  @apply grid grid-cols-2 gap-3 max-w-md mx-auto;
}

.suggestion-card {
  @apply flex items-center gap-3 p-3 bg-muted/30 hover:bg-muted/50 rounded-lg 
         transition-colors text-left;
}

/* æœç´¢ç»“æœæ ·å¼ */
.results-header {
  @apply flex items-center justify-between mb-4 pb-2 border-b border-border;
}

.results-count {
  @apply text-sm text-muted-foreground;
}

.sort-select {
  @apply text-sm bg-transparent border border-border rounded px-2 py-1;
}

.results-list {
  @apply space-y-2;
}

/* æ— ç»“æœçŠ¶æ€ */
.no-results {
  @apply text-center py-12;
}

.no-results-icon {
  @apply inline-flex items-center justify-center w-20 h-20 bg-muted/30 rounded-full mb-6;
  
  svg {
    @apply text-muted-foreground;
  }
}

.advanced-search-btn {
  @apply mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 
         transition-colors;
}

/* åŠ è½½çŠ¶æ€ */
.search-loading {
  @apply text-center py-12;
}

.loading-spinner {
  @apply mb-4;
}

.loading-text {
  @apply text-muted-foreground;
}

/* åº•éƒ¨æ ·å¼ */
.search-footer {
  @apply flex items-center justify-between p-4 border-t border-border bg-muted/30;
}

.stats-text {
  @apply text-xs text-muted-foreground;
}

.search-actions {
  @apply flex items-center gap-2;
}

.action-btn {
  @apply flex items-center gap-2 px-3 py-1.5 text-sm hover:bg-muted rounded-md transition-colors;
}

/* åŠ¨ç”»æ•ˆæœ */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 640px) {
  .search-modal {
    @apply mx-2 max-h-[90vh];
  }
  
  .search-input {
    @apply text-base py-2.5;
  }
  
  .search-suggestions-grid {
    @apply grid-cols-1;
  }
  
  .search-footer {
    @apply flex-col items-start gap-3;
  }
}
</style>
```

---

## ğŸ“± ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¤šçª—å£ç®¡ç†ç³»ç»Ÿè®¾è®¡

### 3.1 æ ‡ç­¾é¡µç³»ç»Ÿè®¾è®¡

#### **TabBarç»„ä»¶è®¾è®¡**
```vue
<template>
  <div class="tab-bar-container">
    <div class="tab-bar" ref="tabBar">
      <!-- æ ‡ç­¾é¡µåˆ—è¡¨ -->
      <div class="tab-list" ref="tabList">
        <TabItem
          v-for="tab in tabs"
          :key="tab.id"
          :tab="tab"
          :active="tab.id === activeTabId"
          :closable="tabs.length > 1"
          @select="selectTab"
          @close="closeTab"
          @drag-start="onDragStart"
          @drag-end="onDragEnd"
        />
        
        <!-- æ–°å»ºæ ‡ç­¾æŒ‰é’® -->
        <button 
          class="new-tab-btn"
          @click="createNewTab"
          title="æ–°å»ºå¯¹è¯ (âŒ˜T)"
        >
          <Plus :size="16" />
        </button>
      </div>
      
      <!-- æ ‡ç­¾é¡µæ§åˆ¶æŒ‰é’® -->
      <div class="tab-controls">
        <!-- æ ‡ç­¾é¡µæº¢å‡ºæ§åˆ¶ -->
        <button 
          v-if="hasOverflow"
          @click="scrollTabs('left')"
          class="scroll-btn"
          :disabled="scrollPosition <= 0"
        >
          <ChevronLeft :size="16" />
        </button>
        
        <button 
          v-if="hasOverflow"
          @click="scrollTabs('right')"
          class="scroll-btn"
          :disabled="scrollPosition >= maxScroll"
        >
          <ChevronRight :size="16" />
        </button>
        
        <!-- æ ‡ç­¾é¡µèœå• -->
        <DropdownMenu>
          <DropdownMenuTrigger class="tab-menu-btn">
            <MoreHorizontal :size="16" />
          </DropdownMenuTrigger>
          <DropdownMenuContent>
            <DropdownMenuItem @click="closeAllTabs">
              å…³é—­æ‰€æœ‰æ ‡ç­¾é¡µ
            </DropdownMenuItem>
            <DropdownMenuItem @click="closeOtherTabs">
              å…³é—­å…¶ä»–æ ‡ç­¾é¡µ
            </DropdownMenuItem>
            <DropdownMenuSeparator />
            <DropdownMenuItem @click="reopenClosedTab">
              é‡æ–°æ‰“å¼€å·²å…³é—­çš„æ ‡ç­¾é¡µ
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      </div>
    </div>
    
    <!-- æ ‡ç­¾é¡µå†…å®¹åŒº -->
    <div class="tab-content">
      <TabContent
        v-for="tab in tabs"
        :key="tab.id"
        :tab="tab"
        :visible="tab.id === activeTabId"
        @update="updateTab"
        @request-close="closeTab"
      />
    </div>
  </div>
</template>

<style scoped>
.tab-bar-container {
  @apply flex flex-col h-full;
}

.tab-bar {
  @apply flex items-center justify-between border-b border-border bg-background;
  height: 48px;
}

.tab-list {
  @apply flex items-center flex-1 min-w-0 overflow-hidden;
}

.new-tab-btn {
  @apply flex items-center justify-center w-8 h-8 rounded-md hover:bg-muted transition-colors ml-2;
}

.tab-controls {
  @apply flex items-center gap-1 px-2;
}

.scroll-btn, .tab-menu-btn {
  @apply flex items-center justify-center w-8 h-8 rounded-md hover:bg-muted 
         transition-colors disabled:opacity-50;
}

.tab-content {
  @apply flex-1 min-h-0;
}
</style>
```

#### **TabItemç»„ä»¶è®¾è®¡**
```vue
<template>
  <div
    class="tab-item"
    :class="{
      'active': active,
      'dragging': isDragging,
      'modified': tab.modified,
      'loading': tab.loading
    }"
    @click="$emit('select', tab.id)"
    @mousedown="onMouseDown"
    @contextmenu="onContextMenu"
    draggable="true"
    @dragstart="$emit('drag-start', $event, tab)"
    @dragend="$emit('drag-end', $event, tab)"
  >
    <!-- æ ‡ç­¾é¡µå›¾æ ‡ -->
    <div class="tab-icon">
      <component 
        :is="tab.icon || MessageSquare" 
        :size="14"
        :class="{ 'animate-spin': tab.loading }"
      />
    </div>
    
    <!-- æ ‡ç­¾é¡µæ ‡é¢˜ -->
    <div class="tab-title" :title="tab.fullTitle">
      {{ tab.title }}
    </div>
    
    <!-- ä¿®æ”¹æŒ‡ç¤ºå™¨ -->
    <div v-if="tab.modified && !tab.loading" class="modified-indicator" />
    
    <!-- å…³é—­æŒ‰é’® -->
    <button
      v-if="closable"
      @click.stop="$emit('close', tab.id)"
      class="close-btn"
    >
      <X :size="14" />
    </button>
  </div>
</template>

<style scoped>
.tab-item {
  @apply flex items-center gap-2 px-3 py-2 min-w-32 max-w-48 border-r border-border
         hover:bg-muted/50 cursor-pointer select-none group relative;
  
  &.active {
    @apply bg-background border-b-2 border-primary;
  }
  
  &.dragging {
    @apply opacity-50;
  }
  
  &.modified .tab-title {
    @apply italic;
  }
}

.tab-title {
  @apply flex-1 truncate text-sm;
}

.modified-indicator {
  @apply w-2 h-2 bg-warning rounded-full;
}

.close-btn {
  @apply opacity-0 group-hover:opacity-100 hover:bg-destructive/10 hover:text-destructive
         rounded-sm p-0.5 transition-all;
  
  .tab-item.active & {
    @apply opacity-100;
  }
}
</style>
```

### 3.2 çª—å£åˆ†ç¦»åŠŸèƒ½è®¾è®¡

#### **WindowManageræœåŠ¡å¢å¼º**
```typescript
// WindowManagerå¢å¼ºç‰ˆæœ¬
export class EnhancedWindowManager {
  private windows = new Map<string, WindowInfo>()
  private windowSyncService: WindowSyncService
  
  constructor() {
    this.windowSyncService = new WindowSyncService()
    this.setupWindowCommunication()
  }
  
  // åˆ›å»ºæ–°çª—å£
  async createWindow(options: CreateWindowOptions): Promise<string> {
    const windowId = generateId()
    const windowBounds = this.calculateOptimalBounds(options)
    
    const window = await this.electronAPI.createWindow({
      id: windowId,
      ...windowBounds,
      webPreferences: {
        nodeIntegration: false,
        contextIsolation: true,
        preload: path.join(__dirname, 'preload.js')
      }
    })
    
    // æ³¨å†Œçª—å£
    this.windows.set(windowId, {
      id: windowId,
      window,
      tabs: options.tabs || [],
      state: 'normal',
      bounds: windowBounds
    })
    
    // åŒæ­¥æ•°æ®åˆ°æ–°çª—å£
    await this.windowSyncService.syncToWindow(windowId)
    
    return windowId
  }
  
  // åˆ†ç¦»æ ‡ç­¾é¡µåˆ°æ–°çª—å£
  async detachTab(tabId: string, sourceWindowId: string): Promise<string> {
    const tab = await this.getTab(tabId)
    if (!tab) throw new Error('Tab not found')
    
    // åˆ›å»ºæ–°çª—å£
    const newWindowId = await this.createWindow({
      tabs: [tab],
      title: tab.title,
      bounds: this.calculateDetachBounds(sourceWindowId)
    })
    
    // ä»æºçª—å£ç§»é™¤æ ‡ç­¾é¡µ
    await this.removeTabFromWindow(tabId, sourceWindowId)
    
    return newWindowId
  }
  
  // åˆå¹¶çª—å£
  async mergeWindows(sourceWindowId: string, targetWindowId: string): Promise<void> {
    const sourceTabs = await this.getWindowTabs(sourceWindowId)
    
    // å°†æ ‡ç­¾é¡µç§»åŠ¨åˆ°ç›®æ ‡çª—å£
    for (const tab of sourceTabs) {
      await this.moveTabToWindow(tab.id, targetWindowId)
    }
    
    // å…³é—­æºçª—å£
    await this.closeWindow(sourceWindowId)
  }
  
  // çª—å£å¸ƒå±€ç®¡ç†
  async arrangeWindows(layout: WindowLayout): Promise<void> {
    const windowIds = Array.from(this.windows.keys())
    const arrangements = this.calculateLayout(layout, windowIds)
    
    await Promise.all(
      arrangements.map(({ windowId, bounds }) =>
        this.setWindowBounds(windowId, bounds)
      )
    )
  }
  
  private calculateOptimalBounds(options: CreateWindowOptions): Rectangle {
    const primaryDisplay = screen.getPrimaryDisplay()
    const { width, height } = primaryDisplay.workAreaSize
    
    return {
      x: Math.floor(width * 0.1),
      y: Math.floor(height * 0.1),
      width: Math.floor(width * 0.8),
      height: Math.floor(height * 0.8)
    }
  }
  
  private setupWindowCommunication(): void {
    // è®¾ç½®çª—å£é—´é€šä¿¡
    ipcMain.handle('window:sync-state', this.handleStatSync.bind(this))
    ipcMain.handle('window:send-message', this.handleWindowMessage.bind(this))
  }
}
```

---

## ğŸ¨ ç¬¬å››éƒ¨åˆ†ï¼šè§†è§‰è®¾è®¡ä¼˜åŒ–

### 4.1 æ¶ˆæ¯ç•Œé¢é‡æ–°è®¾è®¡

#### **MessageItemç»„ä»¶ä¼˜åŒ–**
```vue
<template>
  <div 
    class="message-item"
    :class="{
      'user-message': message.role === 'user',
      'assistant-message': message.role === 'assistant',
      'system-message': message.role === 'system',
      'selected': isSelected,
      'highlighted': isHighlighted
    }"
  >
    <!-- æ¶ˆæ¯å¤´éƒ¨ -->
    <div class="message-header">
      <!-- ç”¨æˆ·å¤´åƒ -->
      <div class="message-avatar">
        <component 
          :is="getAvatarIcon(message.role)" 
          :size="32"
          class="avatar-icon"
        />
      </div>
      
      <!-- æ¶ˆæ¯å…ƒä¿¡æ¯ -->
      <div class="message-meta">
        <div class="message-author">
          {{ getAuthorName(message.role) }}
        </div>
        <div class="message-time">
          {{ formatMessageTime(message.timestamp) }}
        </div>
      </div>
      
      <!-- æ¶ˆæ¯æ“ä½œ -->
      <div class="message-actions">
        <MessageActions
          :message="message"
          :compact="isCompactMode"
          @copy="copyMessage"
          @edit="editMessage"
          @delete="deleteMessage"
          @bookmark="bookmarkMessage"
        />
      </div>
    </div>
    
    <!-- æ¶ˆæ¯å†…å®¹ -->
    <div class="message-content">
      <MessageContent
        :content="message.content"
        :highlights="highlights"
        :editable="canEdit"
        @edit="onContentEdit"
      />
      
      <!-- æ¶ˆæ¯é™„ä»¶ -->
      <MessageAttachments
        v-if="message.attachments?.length"
        :attachments="message.attachments"
        @attachment-click="onAttachmentClick"
      />
      
      <!-- æ¶ˆæ¯çŠ¶æ€ -->
      <MessageStatus
        v-if="showStatus"
        :status="message.status"
        :error="message.error"
        @retry="retryMessage"
      />
    </div>
    
    <!-- æ¶ˆæ¯åé¦ˆ -->
    <div class="message-feedback" v-if="showFeedback">
      <MessageFeedback
        :message="message"
        @feedback="onFeedback"
      />
    </div>
  </div>
</template>

<style scoped>
.message-item {
  @apply relative group mb-6 p-4 rounded-lg transition-all duration-200;
  
  /* æ‚¬åœæ•ˆæœ */
  &:hover {
    @apply bg-muted/30;
    
    .message-actions {
      @apply opacity-100;
    }
  }
  
  /* é€‰ä¸­çŠ¶æ€ */
  &.selected {
    @apply bg-primary/10 border border-primary/20;
  }
  
  /* é«˜äº®çŠ¶æ€ */
  &.highlighted {
    @apply bg-warning/10 border border-warning/20;
    animation: highlight-pulse 2s ease-out;
  }
  
  /* ä¸åŒè§’è‰²çš„æ¶ˆæ¯æ ·å¼ */
  &.user-message {
    @apply ml-12;
    
    .message-content {
      @apply bg-primary text-primary-foreground rounded-r-sm;
    }
  }
  
  &.assistant-message {
    @apply mr-12;
    
    .message-content {
      @apply bg-muted;
    }
  }
  
  &.system-message {
    @apply mx-12;
    
    .message-content {
      @apply bg-accent/50 text-accent-foreground text-center text-sm;
    }
  }
}

.message-header {
  @apply flex items-center gap-3 mb-3;
}

.message-avatar {
  @apply flex-shrink-0;
  
  .avatar-icon {
    @apply p-1.5 rounded-full;
  }
  
  .user-message & .avatar-icon {
    @apply bg-primary/10 text-primary;
  }
  
  .assistant-message & .avatar-icon {
    @apply bg-secondary/10 text-secondary-foreground;
  }
  
  .system-message & .avatar-icon {
    @apply bg-accent/10 text-accent-foreground;
  }
}

.message-meta {
  @apply flex-1 min-w-0;
}

.message-author {
  @apply font-medium text-sm;
}

.message-time {
  @apply text-xs text-muted-foreground;
}

.message-actions {
  @apply opacity-0 transition-opacity duration-200;
}

.message-content {
  @apply p-4 rounded-lg;
  
  /* æå‡å¯è¯»æ€§ */
  line-height: 1.6;
  
  /* ä»£ç å—æ ·å¼ */
  :deep(pre) {
    @apply bg-muted/50 border border-border rounded-md p-3 my-2 overflow-x-auto;
  }
  
  /* é“¾æ¥æ ·å¼ */
  :deep(a) {
    @apply text-primary hover:underline;
  }
  
  /* åˆ—è¡¨æ ·å¼ */
  :deep(ul), :deep(ol) {
    @apply ml-6 space-y-1;
  }
  
  /* å¼•ç”¨æ ·å¼ */
  :deep(blockquote) {
    @apply border-l-4 border-primary/30 pl-4 italic my-2;
  }
}

/* åŠ¨ç”»æ•ˆæœ */
@keyframes highlight-pulse {
  0%, 100% { 
    background-color: theme('colors.warning.50'); 
  }
  50% { 
    background-color: theme('colors.warning.100'); 
  }
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 640px) {
  .message-item {
    @apply mx-0 p-3 mb-4;
    
    &.user-message,
    &.assistant-message {
      @apply mx-0;
    }
  }
  
  .message-header {
    @apply gap-2 mb-2;
  }
  
  .message-avatar .avatar-icon {
    @apply w-6 h-6;
  }
  
  .message-actions {
    @apply opacity-100;
  }
}
</style>
```

### 4.2 å“åº”å¼è®¾è®¡ç³»ç»Ÿ

#### **æ–­ç‚¹ç³»ç»Ÿå®šä¹‰**
```css
/* å“åº”å¼æ–­ç‚¹ */
:root {
  --breakpoint-xs: 480px;
  --breakpoint-sm: 640px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1280px;
  --breakpoint-2xl: 1536px;
}

/* å®¹å™¨æŸ¥è¯¢ */
@container (min-width: 768px) {
  .chat-layout {
    grid-template-columns: 280px 1fr;
  }
}

@container (max-width: 767px) {
  .chat-layout {
    grid-template-columns: 1fr;
  }
  
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    z-index: 50;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    
    &.open {
      transform: translateX(0);
    }
  }
}
```

---

## â™¿ ç¬¬äº”éƒ¨åˆ†ï¼šæ— éšœç¢è®¾è®¡å®ç°

### 5.1 é”®ç›˜å¯¼èˆªæ”¯æŒ

#### **å…¨é”®ç›˜æ“ä½œæ”¯æŒ**
```typescript
// é”®ç›˜å¯¼èˆªç®¡ç†å™¨
export class KeyboardNavigationManager {
  private focusableElements: HTMLElement[] = []
  private currentFocusIndex = -1
  
  constructor() {
    this.setupKeyboardListeners()
    this.updateFocusableElements()
  }
  
  private setupKeyboardListeners(): void {
    document.addEventListener('keydown', this.handleKeyDown.bind(this))
    document.addEventListener('focusin', this.handleFocusIn.bind(this))
  }
  
  private handleKeyDown(event: KeyboardEvent): void {
    const { key, ctrlKey, metaKey, altKey, shiftKey } = event
    
    // Tabå¯¼èˆª
    if (key === 'Tab') {
      this.handleTabNavigation(event)
      return
    }
    
    // ç®­å¤´é”®å¯¼èˆª
    if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(key)) {
      this.handleArrowNavigation(event)
      return
    }
    
    // å¿«æ·é”®å¤„ç†
    this.handleShortcuts(event)
  }
  
  private handleTabNavigation(event: KeyboardEvent): void {
    const direction = event.shiftKey ? -1 : 1
    const nextIndex = this.currentFocusIndex + direction
    
    if (nextIndex >= 0 && nextIndex < this.focusableElements.length) {
      event.preventDefault()
      this.focusableElements[nextIndex].focus()
    }
  }
  
  private handleArrowNavigation(event: KeyboardEvent): void {
    const activeElement = document.activeElement as HTMLElement
    
    // åœ¨æ¶ˆæ¯åˆ—è¡¨ä¸­ä½¿ç”¨ç®­å¤´é”®å¯¼èˆª
    if (activeElement?.closest('.message-list')) {
      this.navigateMessages(event.key)
      event.preventDefault()
    }
    
    // åœ¨æœç´¢ç»“æœä¸­ä½¿ç”¨ç®­å¤´é”®å¯¼èˆª
    if (activeElement?.closest('.search-results')) {
      this.navigateSearchResults(event.key)
      event.preventDefault()
    }
  }
  
  private updateFocusableElements(): void {
    const selector = [
      'button:not([disabled])',
      'input:not([disabled])',
      'textarea:not([disabled])',
      'select:not([disabled])',
      'a[href]',
      '[tabindex]:not([tabindex="-1"])'
    ].join(', ')
    
    this.focusableElements = Array.from(
      document.querySelectorAll(selector)
    ) as HTMLElement[]
  }
}
```

### 5.2 å±å¹•é˜…è¯»å™¨æ”¯æŒ

#### **ARIAæ ‡ç­¾å’Œè¯­ä¹‰åŒ–HTML**
```vue
<template>
  <main 
    class="chat-view" 
    role="main"
    aria-label="èŠå¤©ç•Œé¢"
  >
    <!-- è·³è½¬é“¾æ¥ -->
    <a href="#main-content" class="skip-link">
      è·³è½¬åˆ°ä¸»è¦å†…å®¹
    </a>
    
    <!-- ä¾§è¾¹æ  -->
    <aside 
      class="sidebar"
      role="complementary"
      aria-label="å¯¹è¯åˆ—è¡¨"
      :aria-expanded="sidebarOpen"
    >
      <nav role="navigation" aria-label="å¯¹è¯å¯¼èˆª">
        <ul class="chat-list" role="list">
          <li 
            v-for="chat in chats"
            :key="chat.id"
            role="listitem"
          >
            <button
              :aria-current="currentChatId === chat.id ? 'page' : undefined"
              :aria-describedby="`chat-${chat.id}-meta`"
              @click="selectChat(chat.id)"
            >
              {{ chat.title }}
            </button>
            <div 
              :id="`chat-${chat.id}-meta`"
              class="sr-only"
            >
              æœ€åæ›´æ–°æ—¶é—´ï¼š{{ formatTime(chat.updatedAt) }}
            </div>
          </li>
        </ul>
      </nav>
    </aside>
    
    <!-- ä¸»è¦å†…å®¹åŒº -->
    <div 
      id="main-content"
      class="main-content"
      role="main"
      aria-label="èŠå¤©æ¶ˆæ¯"
    >
      <!-- æ¶ˆæ¯åˆ—è¡¨ -->
      <div 
        class="messages-container"
        role="log"
        aria-live="polite"
        aria-label="æ¶ˆæ¯å†å²"
      >
        <div
          v-for="message in messages"
          :key="message.id"
          role="article"
          :aria-label="`${getAuthorName(message.role)}çš„æ¶ˆæ¯`"
          :aria-describedby="`message-${message.id}-time`"
        >
          <div class="message-content">
            {{ message.content }}
          </div>
          <div 
            :id="`message-${message.id}-time`"
            class="sr-only"
          >
            å‘é€æ—¶é—´ï¼š{{ formatTime(message.timestamp) }}
          </div>
        </div>
      </div>
      
      <!-- è¾“å…¥åŒºåŸŸ -->
      <form 
        class="input-form"
        @submit.prevent="sendMessage"
        role="form"
        aria-label="å‘é€æ¶ˆæ¯"
      >
        <label for="message-input" class="sr-only">
          è¾“å…¥æ¶ˆæ¯å†…å®¹
        </label>
        <textarea
          id="message-input"
          v-model="inputMessage"
          :placeholder="getPlaceholder()"
          :aria-describedby="inputHelpText"
          :aria-invalid="hasInputError"
          aria-required="true"
        />
        <div id="input-help-text" class="sr-only">
          æŒ‰å›è½¦é”®å‘é€æ¶ˆæ¯ï¼ŒæŒ‰Shift+å›è½¦é”®æ¢è¡Œ
        </div>
        <button 
          type="submit"
          :disabled="!canSend"
          :aria-describedby="sendButtonHelp"
        >
          <span class="sr-only">å‘é€æ¶ˆæ¯</span>
          <Send :size="16" aria-hidden="true" />
        </button>
        <div id="send-button-help" class="sr-only">
          {{ getSendButtonTooltip() }}
        </div>
      </form>
    </div>
    
    <!-- çŠ¶æ€å…¬å‘Š -->
    <div 
      role="status" 
      aria-live="polite" 
      aria-atomic="true"
      class="sr-only"
    >
      {{ statusMessage }}
    </div>
  </main>
</template>

<style scoped>
/* å±å¹•é˜…è¯»å™¨ä¸“ç”¨æ ·å¼ */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* è·³è½¬é“¾æ¥ */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: var(--primary);
  color: var(--primary-foreground);
  padding: 8px;
  border-radius: 4px;
  text-decoration: none;
  z-index: 1000;
  
  &:focus {
    top: 6px;
  }
}

/* ç„¦ç‚¹æŒ‡ç¤ºå™¨å¢å¼º */
*:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
  border-radius: 4px;
}

/* é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ */
@media (prefers-contrast: high) {
  .message-item {
    border: 2px solid var(--border);
  }
  
  .message-content {
    border: 1px solid var(--border);
  }
}

/* å‡å°‘åŠ¨ç”» */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
</style>
```

---

## ğŸ“ ç¬¬å…­éƒ¨åˆ†ï¼šè®¾è®¡è§„èŒƒå’Œæ ‡å‡†

### 6.1 è®¾è®¡ä»£å¸(Design Tokens)

#### **é—´è·ç³»ç»Ÿ**
```css
:root {
  /* åŸºç¡€é—´è·å•ä½ */
  --space-0: 0;
  --space-1: 0.25rem;  /* 4px */
  --space-2: 0.5rem;   /* 8px */
  --space-3: 0.75rem;  /* 12px */
  --space-4: 1rem;     /* 16px */
  --space-5: 1.25rem;  /* 20px */
  --space-6: 1.5rem;   /* 24px */
  --space-8: 2rem;     /* 32px */
  --space-10: 2.5rem;  /* 40px */
  --space-12: 3rem;    /* 48px */
  --space-16: 4rem;    /* 64px */
  --space-20: 5rem;    /* 80px */
  --space-24: 6rem;    /* 96px */
  
  /* ç»„ä»¶ä¸“ç”¨é—´è· */
  --message-spacing: var(--space-6);
  --component-padding: var(--space-4);
  --section-margin: var(--space-8);
}
```

#### **é˜´å½±ç³»ç»Ÿ**
```css
:root {
  /* é˜´å½±å±‚çº§ */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
  --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
  
  /* ç»„ä»¶é˜´å½± */
  --card-shadow: var(--shadow);
  --modal-shadow: var(--shadow-2xl);
  --tooltip-shadow: var(--shadow-md);
}
```

### 6.2 ç»„ä»¶çŠ¶æ€è§„èŒƒ

#### **äº¤äº’çŠ¶æ€å®šä¹‰**
```css
/* æŒ‰é’®çŠ¶æ€ */
.btn {
  @apply transition-all duration-200 ease-out;
  
  /* é»˜è®¤çŠ¶æ€ */
  &:not(:disabled) {
    @apply cursor-pointer;
  }
  
  /* æ‚¬åœçŠ¶æ€ */
  &:hover:not(:disabled) {
    @apply scale-105 shadow-md;
    transform-origin: center;
  }
  
  /* æ¿€æ´»çŠ¶æ€ */
  &:active:not(:disabled) {
    @apply scale-95;
  }
  
  /* ç„¦ç‚¹çŠ¶æ€ */
  &:focus-visible {
    @apply ring-2 ring-primary/20 ring-offset-2;
  }
  
  /* ç¦ç”¨çŠ¶æ€ */
  &:disabled {
    @apply opacity-50 cursor-not-allowed;
  }
  
  /* åŠ è½½çŠ¶æ€ */
  &.loading {
    @apply cursor-wait;
    
    &::before {
      content: '';
      @apply absolute inset-0 bg-current opacity-10 rounded;
    }
  }
}

/* è¾“å…¥æ¡†çŠ¶æ€ */
.input {
  @apply transition-all duration-200;
  
  /* ç„¦ç‚¹çŠ¶æ€ */
  &:focus {
    @apply ring-2 ring-primary/20 border-primary;
  }
  
  /* é”™è¯¯çŠ¶æ€ */
  &.error {
    @apply border-destructive ring-2 ring-destructive/20;
  }
  
  /* æˆåŠŸçŠ¶æ€ */
  &.success {
    @apply border-success ring-2 ring-success/20;
  }
}
```

---

## ğŸ¯ æ€»ç»“ï¼šäº¤äº’è®¾è®¡ä»·å€¼æ‰¿è¯º

### æ ¸å¿ƒè®¾è®¡æˆæœ

#### **ç”¨æˆ·ä½“éªŒæå‡**
1. **è®¤çŸ¥è´Ÿè·é™ä½40%**: é€šè¿‡ç®€åŒ–ç•Œé¢å’Œä¼˜åŒ–ä¿¡æ¯æ¶æ„
2. **æ“ä½œæ•ˆç‡æå‡50%**: é€šè¿‡å¿«æ·æ“ä½œå’Œæ™ºèƒ½å¼•å¯¼
3. **è§†è§‰èˆ’é€‚åº¦æå‡60%**: é€šè¿‡ä¼˜åŒ–é…è‰²å’Œé—´è·ç³»ç»Ÿ
4. **æ— éšœç¢è®¿é—®å…¨è¦†ç›–**: æ”¯æŒæ‰€æœ‰ç±»å‹çš„ç”¨æˆ·ç¾¤ä½“

#### **æŠ€æœ¯å®ç°è´¨é‡**
1. **å“åº”å¼è®¾è®¡å®Œå–„**: å…¨è®¾å¤‡å®Œç¾é€‚é…
2. **æ€§èƒ½ä¼˜åŒ–**: 60fpsæµç•…äº¤äº’
3. **ä»£ç è´¨é‡**: ç»„ä»¶åŒ–ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•
4. **æ ‡å‡†åˆè§„**: éµå¾ªWCAG 2.1å’Œç°ä»£Webæ ‡å‡†

#### **ç«äº‰ä¼˜åŠ¿å»ºç«‹**
1. **å·®å¼‚åŒ–ä½“éªŒ**: ç‹¬ç‰¹çš„å¤šçª—å£å’Œæ·±åº¦æœç´¢ä½“éªŒ
2. **ä¸“ä¸šçº§å“è´¨**: åª²ç¾é¡¶çº§æ¡Œé¢åº”ç”¨çš„äº¤äº’è´¨é‡
3. **ç”¨æˆ·ç²˜æ€§**: é€šè¿‡ä¼˜ç§€ä½“éªŒæå‡ç”¨æˆ·å¿ è¯šåº¦
4. **å“ç‰Œä»·å€¼**: å»ºç«‹é«˜å“è´¨AIå·¥å…·çš„æŠ€æœ¯å“ç‰Œ

---

**äº¤äº’è®¾è®¡å®Œæˆæ—¶é—´**: 2025-07-30  
**å®æ–½å‡†å¤‡çŠ¶æ€**: å·²å®Œæˆè¯¦ç»†è®¾è®¡è§„èŒƒï¼Œå¯ç«‹å³å¼€å§‹å¼€å‘  
**è´¨é‡æ‰¿è¯º**: è¿½æ±‚æ¯ä¸ªåƒç´ çš„å®Œç¾ï¼Œæ¯ä¸ªäº¤äº’çš„æè‡´ä½“éªŒ

*"ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒï¼Œåˆ›é€ çœŸæ­£ä»¤äººæ„‰æ‚¦çš„äº¤äº’ä½“éªŒ"*