/**
 * UI 关键问题修复 - 基于用户反馈
 * 
 * 解决的问题：
 * 1. 顶部文字与软件边框距离不合理
 * 2. 字体大小层级混乱
 * 3. 对话框左右边距不一致
 * 4. 整体间距缺乏规范
 */

/* ============== 1. 顶部区域间距修复 ============== */

/* 修复顶部标题栏间距 */
.chat-header {
  /* 重新定义顶部区域的安全间距 */
  padding: 12px 24px !important;
  min-height: 64px !important;
  
  /* 确保与操作系统边框的合理距离 */
  margin-top: 0 !important;
  
  /* macOS 特殊处理 */
  &.macos {
    padding-top: 20px !important; /* 为 macOS 红绿灯按钮预留空间 */
  }
}

/* 修复顶部标题文字的边距 */
.chat-title {
  font-size: 18px !important;      /* 标准化字体大小 */
  font-weight: 600 !important;     /* 增强视觉层级 */
  line-height: 1.2 !important;     /* 优化行高 */
  margin: 0 !important;             /* 移除默认边距 */
  padding: 0 !important;            /* 移除默认内边距 */
  
  /* 确保文字垂直居中 */
  display: flex;
  align-items: center;
  
  /* 防止文字溢出 */
  max-width: 400px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* 状态信息的间距优化 */
.status-info {
  font-size: 13px !important;
  margin-top: 4px !important;
  color: hsl(var(--muted-foreground)) !important;
  line-height: 1.3 !important;
}

/* ============== 2. 字体系统标准化 ============== */

/* 主要标题 */
h1, .heading-1 {
  font-size: 28px !important;
  font-weight: 700 !important;
  line-height: 1.2 !important;
  letter-spacing: -0.02em !important;
}

/* 次级标题 */
h2, .heading-2 {
  font-size: 22px !important;
  font-weight: 600 !important;
  line-height: 1.3 !important;
  letter-spacing: -0.015em !important;
}

/* 小标题 */
h3, .heading-3 {
  font-size: 18px !important;
  font-weight: 600 !important;
  line-height: 1.4 !important;
}

/* 主体文字 */
.message-content,
.text-body,
p {
  font-size: 15px !important;      /* 标准化为15px，提升可读性 */
  line-height: 1.6 !important;     /* 优化行高比例 */
  font-weight: 400 !important;     /* 正常字重 */
  letter-spacing: 0 !important;    /* 正常字符间距 */
}

/* 小字文本 */
.text-small,
.caption,
small {
  font-size: 13px !important;
  line-height: 1.5 !important;
  color: hsl(var(--muted-foreground)) !important;
}

/* 极小文本 */
.text-xs {
  font-size: 11px !important;
  line-height: 1.4 !important;
  color: hsl(var(--muted-foreground)) !important;
}

/* ============== 3. 对话框边距标准化 ============== */

/* 主消息容器 */
.messages-container,
.chat-content {
  max-width: 768px !important;           /* 标准化最大宽度 */
  margin: 0 auto !important;             /* 水平居中 */
  padding: 0 24px !important;            /* 统一左右边距 */
  box-sizing: border-box !important;
}

/* 消息气泡容器 */
.message-item,
.message-bubble {
  margin-bottom: 16px !important;        /* 统一消息间距 */
  padding: 16px 20px !important;         /* 统一内边距 */
  border-radius: 12px !important;        /* 标准化圆角 */
  
  /* 确保边距一致性 */
  margin-left: 0 !important;
  margin-right: 0 !important;
}

/* 用户消息对齐 */
.message-item.user {
  margin-left: auto !important;
  margin-right: 0 !important;
  max-width: 85% !important;
}

/* AI消息对齐 */
.message-item.assistant {
  margin-left: 0 !important;
  margin-right: auto !important;
  max-width: 90% !important;
}

/* ============== 4. 侧边栏间距优化 ============== */

/* 侧边栏主容器 */
.sidebar {
  padding: 0 !important;                 /* 重置默认内边距 */
  border-right: 1px solid hsl(var(--border)) !important;
}

/* 侧边栏头部 */
.sidebar-header {
  padding: 20px 20px 16px 20px !important;  /* 标准化头部内边距 */
  border-bottom: 1px solid hsl(var(--border) / 0.1) !important;
}

.sidebar-header h1 {
  font-size: 20px !important;
  font-weight: 700 !important;
  margin: 0 !important;
  line-height: 1.2 !important;
}

/* 搜索容器 */
.search-container {
  padding: 16px 20px !important;         /* 统一搜索框边距 */
}

/* 聊天列表容器 */
.chat-list,
.sidebar .overflow-y-auto {
  padding: 8px 12px !important;          /* 优化列表容器边距 */
}

/* 聊天项目 */
.chat-item {
  padding: 12px 16px !important;         /* 统一聊天项内边距 */
  margin-bottom: 4px !important;         /* 减小项目间距 */
  border-radius: 8px !important;         /* 统一圆角 */
}

.chat-item h3 {
  font-size: 14px !important;            /* 标准化聊天标题字体 */
  font-weight: 500 !important;
  line-height: 1.3 !important;
  margin: 0 0 4px 0 !important;
}

.chat-item p {
  font-size: 12px !important;            /* 标准化时间戳字体 */
  line-height: 1.3 !important;
  margin: 0 !important;
  color: hsl(var(--muted-foreground)) !important;
}

/* 侧边栏底部 */
.sidebar-footer {
  padding: 16px 20px 20px 20px !important;  /* 标准化底部边距 */
  border-top: 1px solid hsl(var(--border) / 0.1) !important;
}

/* ============== 5. 输入区域优化 ============== */

/* 输入区域容器 */
.input-area {
  padding: 20px 24px 24px 24px !important;   /* 统一输入区边距 */
  border-top: 1px solid hsl(var(--border) / 0.2) !important;
}

/* 输入框容器 */
.input-container {
  max-width: 768px !important;           /* 与消息容器宽度一致 */
  margin: 0 auto !important;             /* 水平居中 */
  padding: 12px 16px !important;         /* 标准化内边距 */
  border-radius: 24px !important;        /* 现代化圆角 */
  
  /* 优化边框和背景 */
  border: 1px solid hsl(var(--border)) !important;
  background: hsl(var(--background)) !important;
}

/* 文本输入框 */
.input-container textarea {
  font-size: 15px !important;            /* 与消息文字大小一致 */
  line-height: 1.5 !important;           /* 优化行高 */
  padding: 8px 0 !important;             /* 垂直内边距 */
  border: none !important;               /* 移除边框 */
  background: transparent !important;    /* 透明背景 */
  resize: none !important;               /* 禁用手动调整大小 */
  outline: none !important;              /* 移除默认外框 */
}

/* 按钮间距优化 */
.input-container button {
  padding: 8px !important;               /* 统一按钮内边距 */
  border-radius: 16px !important;        /* 圆形按钮 */
  min-width: 36px !important;            /* 最小点击区域 */
  min-height: 36px !important;           /* 最小点击区域 */
}

/* ============== 6. 响应式间距调整 ============== */

/* 平板设备 */
@media (max-width: 1024px) {
  .messages-container,
  .chat-content {
    padding: 0 20px !important;
  }
  
  .input-area {
    padding: 16px 20px 20px 20px !important;
  }
  
  .chat-header {
    padding: 12px 20px !important;
  }
}

/* 移动设备 */
@media (max-width: 768px) {
  .messages-container,
  .chat-content {
    padding: 0 16px !important;          /* 移动端减小边距 */
  }
  
  .input-area {
    padding: 12px 16px 16px 16px !important;
  }
  
  .chat-header {
    padding: 8px 16px !important;
    min-height: 56px !important;         /* 移动端减小高度 */
  }
  
  .chat-title {
    font-size: 16px !important;          /* 移动端减小字体 */
  }
  
  .message-content,
  .text-body,
  p {
    font-size: 15px !important;          /* 保持可读性 */
  }
  
  .message-item,
  .message-bubble {
    padding: 12px 16px !important;       /* 移动端减小内边距 */
  }
  
  .sidebar-header {
    padding: 16px !important;
  }
  
  .chat-list,
  .sidebar .overflow-y-auto {
    padding: 8px !important;
  }
}

/* 小屏手机 */
@media (max-width: 480px) {
  .messages-container,
  .chat-content {
    padding: 0 12px !important;
  }
  
  .input-area {
    padding: 12px !important;
  }
  
  .chat-header {
    padding: 8px 12px !important;
  }
  
  .message-item,
  .message-bubble {
    padding: 10px 14px !important;
  }
}

/* ============== 7. 视觉层级增强 ============== */

/* 增强焦点状态 */
.input-container:focus-within {
  border-color: hsl(var(--primary)) !important;
  box-shadow: 0 0 0 3px hsl(var(--primary) / 0.1) !important;
}

/* 优化选中状态 */
.chat-item.active,
.chat-item:hover {
  background: hsl(var(--secondary) / 0.6) !important;
  transform: translateX(2px) !important;
}

/* 消息悬停效果 */
.message-item:hover {
  background: hsl(var(--muted) / 0.3) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
}

/* ============== 8. 兼容性修复 ============== */

/* 确保所有浏览器的一致性 */
* {
  box-sizing: border-box !important;
}

/* WebKit 滚动条样式 */
.sidebar::-webkit-scrollbar,
.messages-container::-webkit-scrollbar {
  width: 6px !important;
}

.sidebar::-webkit-scrollbar-track,
.messages-container::-webkit-scrollbar-track {
  background: transparent !important;
}

.sidebar::-webkit-scrollbar-thumb,
.messages-container::-webkit-scrollbar-thumb {
  background: hsl(var(--border)) !important;
  border-radius: 3px !important;
}

.sidebar::-webkit-scrollbar-thumb:hover,
.messages-container::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--border) / 0.8) !important;
}

/* ============== 9. 性能优化 ============== */

/* GPU 加速关键元素 */
.chat-header,
.input-area,
.sidebar {
  transform: translateZ(0) !important;
  will-change: transform !important;
}

/* 平滑滚动 */
.messages-container,
.sidebar {
  scroll-behavior: smooth !important;
}

/* ============== 10. 无障碍优化 ============== */

/* 确保足够的对比度 */
.text-body,
.message-content {
  color: hsl(var(--foreground)) !important;
}

.text-small,
.caption {
  color: hsl(var(--muted-foreground)) !important;
}

/* 焦点指示器 */
button:focus-visible,
input:focus-visible,
textarea:focus-visible {
  outline: 2px solid hsl(var(--primary)) !important;
  outline-offset: 2px !important;
}

/* 减少动画（用户偏好） */
@media (prefers-reduced-motion: reduce) {
  * {
    transition-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
  }
}